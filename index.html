<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formation Contrats Installation SEED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Off-white, Charcoal, Soft Blue) -->
    <!-- Application Structure Plan: A four-part SPA (Accueil, Comparateur, Argumentaire, Questionnaire) is used to guide the user from foundational knowledge to practical application and self-assessment. The core remains the interactive comparator. The new questionnaire section provides a clear pedagogical loop (test-learn-retest). -->
    <!-- Visualization & Content Choices: Report info (Contract details) -> Goal (Compare) -> Viz (Side-by-side text blocks, HTML/CSS diagrams, Integrated HTML/CSS progress bars with text examples) -> Interaction (User clicks a criterion to update all views). Justification: Adding text examples to the risk analysis makes the abstract data tangible. Report info (Learning assessment) -> Goal (Evaluate) -> Viz (Tabbed quiz interface). Justification: An Avant/Apr√®s structure allows users to measure their knowledge gain, making the training more effective. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4;
            color: #333333;
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active {
            border-bottom-color: #3B82F6;
            color: #FFFFFF;
        }
        .diagram-box {
            border: 2px solid #9CA3AF;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
            background-color: white;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            min-width: 120px;
        }
        .diagram-arrow {
            position: relative;
            flex-grow: 1;
            height: 2px;
            background-color: #6B7280;
            margin: 0 1rem;
        }
        .diagram-arrow-label {
            position: absolute;
            top: -22px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #F9FAFB;
            padding: 0 8px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #4B5563;
            white-space: nowrap;
        }
        .diagram-arrow::after {
            content: '';
            position: absolute;
            right: -1px;
            top: -4px;
            width: 0;
            height: 0;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            border-left: 8px solid #6B7280;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .clause-box {
            background-color: #E0E7FF;
            border-left: 4px solid #4F46E5;
            padding: 1rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            color: #312E81;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-gray-800 sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center gap-4">
                    <a href="#accueil">
                        <img src="https://www.helexia.green/wp-content/uploads/2023/12/helexia-logo-header-white.svg" alt="Logo Helexia" class="h-8">
                    </a>
                    <h1 class="hidden md:block text-xl font-bold text-white">Formation Contrats Installation SEED</h1>
                </div>
                <nav class="hidden sm:flex items-center space-x-4 lg:space-x-8">
                    <a href="#accueil" class="nav-link text-gray-300 hover:text-white font-medium pb-1">Les Bases</a>
                    <a href="#comparateur" class="nav-link text-gray-300 hover:text-white font-medium pb-1">Comparateur</a>
                    <a href="#argumentaire" class="nav-link text-gray-300 hover:text-white font-medium pb-1">Argumentaire</a>
                    <a href="#questionnaire" class="nav-link text-gray-300 hover:text-white font-medium pb-1">Questionnaire</a>
                </nav>
                <div class="sm:hidden">
                    <select id="mobile-nav" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 bg-gray-700 text-white">
                        <option value="accueil">Les Bases</option>
                        <option value="comparateur">Comparateur</option>
                        <option value="argumentaire">Argumentaire</option>
                        <option value="questionnaire">Questionnaire</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="accueil" class="main-section container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 sm:text-4xl">Les Fondations du Projet</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Avant de comparer les contrats, il est essentiel de ma√Ætriser le vocabulaire et les concepts fondamentaux. Cette section d√©finit les r√¥les de chaque acteur et explique la diff√©rence capitale entre une obligation de moyens et une obligation de r√©sultat.</p>
            </div>
            
            <div class="bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 rounded-md mb-12 max-w-4xl mx-auto" role="alert">
                <div class="flex">
                    <div class="py-1"><svg class="fill-current h-6 w-6 text-blue-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zM9 11v4h2v-4H9zm0-4h2v2H9V7z"/></svg></div>
                    <div>
                        <p class="font-bold">√âvaluez vos connaissances !</p>
                        <p class="text-sm">Avant de commencer, nous vous recommandons de r√©pondre √† notre questionnaire pour √©valuer votre niveau de d√©part.</p>
                        <a href="#questionnaire" id="alert-quiz-link" class="mt-2 inline-block bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-700">Aller au questionnaire</a>
                    </div>
                </div>
            </div>

            <div class="mb-12">
                <h3 class="text-2xl font-bold text-center mb-8">Les Acteurs Fondamentaux d'un Projet</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h4 class="font-bold text-xl mb-3">üë§ Client / Ma√Ætre d‚ÄôOuvrage (MOA)</h4>
                        <p class="text-gray-700 mb-2"><b>R√¥le :</b> Le porteur du projet, celui qui d√©finit le besoin, le budget et le calendrier. C'est le propri√©taire final de l'ouvrage.</p>
                        <p class="text-gray-700"><b>Responsabilit√© :</b> Prendre les d√©cisions finales, valider les √©tapes, et assurer le financement du projet.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h4 class="font-bold text-xl mb-3">üë∑ Prestataire / Entreprise de Travaux</h4>
                        <p class="text-gray-700 mb-2"><b>R√¥le :</b> Le r√©alisateur technique du projet. Il ex√©cute les travaux de construction ou d'installation.</p>
                        <p class="text-gray-700"><b>Responsabilit√© :</b> Mettre en ≈ìuvre les plans et sp√©cifications techniques, en respectant les r√®gles de l'art, la s√©curit√© et les d√©lais convenus.</p>
                    </div>
                </div>
            </div>

            <div class="mb-12">
                <h3 class="text-2xl font-bold text-center mb-8">Les R√¥les d'Helexia : AMO, MOE, EPCiste</h3>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-10">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h4 class="font-bold text-xl mb-3">üß≠ Assistant √† Ma√Ætrise d‚ÄôOuvrage (AMO)</h4>
                        <p class="text-gray-700 mb-2"><b>R√¥le :</b> L‚ÄôAMO accompagne le ma√Ætre d‚Äôouvrage (le client) dans la d√©finition, la gestion et le pilotage du projet.</p>
                        <p class="text-gray-700"><b>Responsabilit√© :</b> Aide √† la r√©daction du cahier des charges, conseil sur les choix techniques, juridiques, financiers et suivi du projet.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h4 class="font-bold text-xl mb-3">üèóÔ∏è Ma√Ætre d‚Äô≈ìuvre (MOE)</h4>
                        <p class="text-gray-700 mb-2"><b>R√¥le :</b> Le ma√Ætre d‚Äô≈ìuvre est responsable de la conception technique du projet et du suivi de sa r√©alisation.</p>
                        <p class="text-gray-700"><b>Responsabilit√© :</b> √âlaboration des plans, coordination des entreprises et suivi du respect des d√©lais, du budget et de la qualit√©.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h4 class="font-bold text-xl mb-3">üîß EPCiste (Engineering, Procurement, Construction)</h4>
                        <p class="text-gray-700 mb-2"><b>R√¥le :</b> L‚ÄôEPCiste est une entreprise ou un consortium qui prend en charge l‚Äôing√©nierie, les achats et la construction d‚Äôun projet, souvent dans le cadre d‚Äôun contrat "cl√© en main".</p>
                        <p class="text-gray-700"><b>Responsabilit√© :</b> Il livre un ouvrage complet, pr√™t √† l‚Äôusage, en respectant les d√©lais, le budget et les sp√©cifications techniques.</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md overflow-x-auto">
                    <table class="w-full text-left">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="p-4 font-semibold">Fonction</th>
                                <th class="p-4 font-semibold text-center">Porte le projet ?</th>
                                <th class="p-4 font-semibold text-center">Con√ßoit ?</th>
                                <th class="p-4 font-semibold text-center">R√©alise ?</th>
                                <th class="p-4 font-semibold text-center">Conseille le client ?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-4 font-bold">AMO</td>
                                <td class="p-4 text-center text-2xl text-red-600">‚ùå</td>
                                <td class="p-4 text-center text-2xl text-red-600">‚ùå</td>
                                <td class="p-4 text-center text-2xl text-red-600">‚ùå</td>
                                <td class="p-4 text-center text-2xl text-green-600">‚úÖ</td>
                            </tr>
                            <tr class="border-b">
                                <td class="p-4 font-bold">Ma√Ætre d‚Äô≈ìuvre</td>
                                <td class="p-4 text-center text-2xl text-red-600">‚ùå</td>
                                <td class="p-4 text-center text-2xl text-green-600">‚úÖ</td>
                                <td class="p-4 text-center text-lg text-gray-600">‚úÖ (suivi)</td>
                                <td class="p-4 text-center text-2xl text-red-600">‚ùå</td>
                            </tr>
                            <tr>
                                <td class="p-4 font-bold">EPCiste</td>
                                <td class="p-4 text-center text-2xl text-green-600">‚úÖ</td>
                                <td class="p-4 text-center text-2xl text-green-600">‚úÖ</td>
                                <td class="p-4 text-center text-2xl text-green-600">‚úÖ</td>
                                <td class="p-4 text-center text-2xl text-red-600">‚ùå</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div>
                <h3 class="text-2xl font-bold text-center mb-8">Moyens vs. R√©sultat : Le Concept Cl√©</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg border-l-4 border-blue-500 shadow-md">
                        <h4 class="font-bold text-xl mb-3">Obligation de Moyens</h4>
                        <p class="text-gray-700">S'engager √† tout mettre en ≈ìuvre (comp√©tences, ressources) pour atteindre un but, sans garantir le r√©sultat final. La preuve d'une faute incombe au client.</p>
                        <p class="mt-4 text-sm text-gray-500"><strong>Analogie CVC :</strong> Un expert qui s'engage √† <b>concevoir et installer le meilleur syst√®me CVC possible</b> pour votre b√¢timent, en respectant toutes les r√®gles de l'art pour optimiser sa performance.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg border-l-4 border-green-500 shadow-md">
                        <h4 class="font-bold text-xl mb-3">Obligation de R√©sultat</h4>
                        <p class="text-gray-700">S'engager √† ce que l'objectif soit atteint. La simple non-atteinte du r√©sultat suffit √† engager la responsabilit√©.</p>
                        <p class="mt-4 text-sm text-gray-500"><strong>Analogie CVC :</strong> Un expert qui s'engage √† ce que la nouvelle CVC <b>maintienne la temp√©rature de votre salle de serveurs en dessous de 21¬∞C</b>. Le r√©sultat doit √™tre atteint, peu importe les moyens.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="comparateur" class="main-section bg-white py-16">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-900 sm:text-4xl">Comparateur Interactif des Contrats</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Utilisez les boutons ci-dessous pour comparer les contrats AMO, MOE et EPC sur des crit√®res sp√©cifiques.</p>
                </div>

                <div class="flex flex-wrap justify-center gap-2 sm:gap-4 mb-10">
                    <button data-criterion="schema" class="comparator-btn bg-blue-500 text-white px-4 py-2 rounded-full shadow">Sch√©ma Contractuel</button>
                    <button data-criterion="obligations" class="comparator-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Obligations & Assurances</button>
                    <button data-criterion="analyse" class="comparator-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full">Analyse Commerciale</button>
                </div>

                <div id="comparator-content">
                    <div id="comparator-grid-view" class="hidden grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="border border-gray-200 rounded-lg p-6 bg-gray-50">
                            <h3 class="font-bold text-2xl text-center mb-4">AMO</h3>
                            <div id="content-amo" class="space-y-4"></div>
                        </div>
                        <div class="border border-gray-200 rounded-lg p-6 bg-gray-50">
                            <h3 class="font-bold text-2xl text-center mb-4">MOE</h3>
                            <div id="content-moe" class="space-y-4"></div>
                        </div>
                        <div class="border border-gray-200 rounded-lg p-6 bg-gray-50">
                            <h3 class="font-bold text-2xl text-center mb-4">EPC</h3>
                            <div id="content-epc" class="space-y-4"></div>
                        </div>
                    </div>

                    <div id="schema-details-view">
                        <div id="schema-tabs" class="border-b border-gray-200 mb-6">
                            <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                                <button data-schema="amo" class="schema-tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">AMO</button>
                                <button data-schema="moe" class="schema-tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">MOE</button>
                                <button data-schema="epc" class="schema-tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">EPC</button>
                            </nav>
                        </div>
                        <div id="schema-content-display" class="bg-gray-50 p-6 sm:p-8 rounded-lg">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="argumentaire" class="main-section container mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 sm:text-4xl">L'Argumentaire Commercial</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Cette section est votre bo√Æte √† outils. Utilisez l'arbre de d√©cision pour orienter votre proposition et pr√©parez-vous √† r√©pondre aux objections les plus courantes avec des arguments solides et clairs.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                <div>
                    <h3 class="text-2xl font-bold mb-6">Arbre de D√©cision Commercial</h3>
                    <div id="decision-tree" class="bg-white p-6 rounded-lg shadow-md">
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl font-bold mb-6">R√©ponses aux Objections</h3>
                    <div id="objections-accordion" class="space-y-4">
                    </div>
                </div>
            </div>
        </section>
        
        <section id="questionnaire" class="main-section container mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 sm:text-4xl">Questionnaire d'√âvaluation</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">√âvaluez votre compr√©hension des concepts cl√©s avant et apr√®s avoir parcouru la formation.</p>
            </div>
            <div id="quiz-tabs" class="border-b border-gray-200 mb-6">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button data-quiz="avant" class="quiz-tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Avant la formation</button>
                    <button data-quiz="apres" class="quiz-tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Apr√®s la formation</button>
                </nav>
            </div>
            <div id="quiz-content" class="bg-white p-6 sm:p-8 rounded-lg shadow-md">
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center">
            <p>&copy; Helexia 2025</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const trainingData = {
                schema: {
                    amo: `
                        <div class="space-y-8">
                            <div>
                                <h4 class="font-semibold text-xl text-center mb-6">Sch√©ma AMO : Le Client pilote</h4>
                                <div class="flex flex-col items-center">
                                    <div class="diagram-box">Client</div>
                                    <div class="w-px h-8 bg-gray-400"></div>
                                    <div class="w-full max-w-xl h-px bg-gray-400 relative">
                                        <div class="absolute left-0 top-0 w-px h-8 bg-gray-400"></div>
                                        <div class="absolute right-0 top-0 w-px h-8 bg-gray-400"></div>
                                    </div>
                                    <div class="flex w-full max-w-xl justify-between mt-8">
                                        <div class="flex flex-col items-center">
                                            <div class="diagram-box">Helexia</div>
                                            <div class="text-sm mt-2 text-gray-600">Contrat AMO</div>
                                        </div>
                                        <div class="flex flex-col items-center">
                                            <div class="diagram-box">Entreprise</div>
                                            <div class="text-sm mt-2 text-gray-600">Contrat Travaux</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <h5 class="font-bold text-lg mb-3">Obligations G√©n√©rales</h5>
                                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                                        <li><b>Client :</b> Doit prendre les d√©cisions, fournir les informations, et payer Helexia ET l'Entreprise.</li>
                                        <li><b>Helexia :</b> Doit conseiller et assister le client (obligation de moyens).</li>
                                        <li><b>Entreprise :</b> Doit r√©aliser les travaux pour le Client (obligation de r√©sultat).</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-bold text-lg mb-3">Flux Financiers (Qui paie qui ?)</h5>
                                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                                        <li><b>Client ‚Üí Helexia</b> (pour les honoraires de conseil).</li>
                                        <li><b>Client ‚Üí Entreprise</b> (pour les factures de travaux).</li>
                                    </ul>
                                </div>
                            </div>
                            <hr>
                             <div>
                                <h5 class="font-bold text-lg mb-3 text-center">Cas Concret : Installation CVC</h5>
                                <div class="grid md:grid-cols-2 gap-8 mt-4">
                                    <div class="bg-white p-4 rounded-lg border">
                                        <h6 class="font-semibold">R√¥le d'Helexia</h6>
                                        <p class="text-sm text-gray-600 mt-2">Nous aidons le client √† r√©diger le cahier des charges, √† analyser les devis de 3 installateurs CVC, et nous recommandons le plus pertinent. Nous suivons les r√©unions de chantier pour le client.</p>
                                        <p class="text-sm text-gray-600 mt-2"><b>Obligation :</b> Notre responsabilit√© s'arr√™te √† la qualit√© de notre conseil. Si l'installateur choisi par le client fait mal son travail, ce n'est pas notre faute (sauf si nous avons mal conseill√©).</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border">
                                        <h6 class="font-semibold">R√¥le du Prestataire (Installateur CVC)</h6>
                                        <p class="text-sm text-gray-600 mt-2">Il signe un contrat directement avec le client. Il est responsable de la bonne installation du mat√©riel CVC conform√©ment au devis accept√© par le client.</p>
                                        <p class="text-sm text-gray-600 mt-2"><b>Obligation :</b> Il a une obligation de r√©sultat envers le client. La CVC doit fonctionner.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `,
                    moe: `
                       <div class="space-y-8">
                            <div>
                                <h4 class="font-semibold text-xl text-center mb-6">Sch√©ma MOE : Helexia con√ßoit et supervise</h4>
                                <div class="flex flex-col items-center">
                                    <div class="diagram-box">Client</div>
                                    <div class="w-px h-8 bg-gray-400"></div>
                                    <div class="w-full max-w-xl h-px bg-gray-400 relative">
                                        <div class="absolute left-0 top-0 w-px h-8 bg-gray-400"></div>
                                        <div class="absolute right-0 top-0 w-px h-8 bg-gray-400"></div>
                                    </div>
                                    <div class="flex w-full max-w-xl justify-between mt-8">
                                        <div class="flex flex-col items-center">
                                            <div class="diagram-box">Helexia</div>
                                            <div class="text-sm mt-2 text-gray-600">Contrat MOE</div>
                                        </div>
                                        <div class="flex flex-col items-center">
                                            <div class="diagram-box">Entreprise</div>
                                            <div class="text-sm mt-2 text-gray-600">Contrat Travaux</div>
                                        </div>
                                    </div>
                                </div>
                                <p class="text-center max-w-3xl mx-auto mt-8 text-gray-700"><b>Sur le fond :</b> La structure est similaire √† l'AMO : le Client signe deux contrats distincts. La diff√©rence fondamentale est la nature du r√¥le d'Helexia : nous ne sommes plus simple conseiller, nous sommes <b>concepteur et pilote</b>. Nous sommes responsables de la conception technique et de la supervision des travaux r√©alis√©s par l'Entreprise.</p>
                            </div>
                            <hr>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <h5 class="font-bold text-lg mb-3">Obligations G√©n√©rales</h5>
                                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                                        <li><b>Client :</b> Doit payer Helexia pour la conception/supervision ET l'Entreprise pour les travaux.</li>
                                        <li><b>Helexia :</b> Doit fournir une conception correcte et superviser le chantier (obligation de r√©sultat sur la conception).</li>
                                        <li><b>Entreprise :</b> Doit r√©aliser les travaux pour le Client, sous la supervision d'Helexia.</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-bold text-lg mb-3">Flux Financiers (Qui paie qui ?)</h5>
                                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                                        <li><b>Client ‚Üí Helexia</b> (pour les honoraires de conception et suivi).</li>
                                        <li><b>Client ‚Üí Entreprise</b> (pour les factures de travaux).</li>
                                    </ul>
                                </div>
                            </div>
                            <hr>
                            <div>
                                <h5 class="font-bold text-lg mb-3 text-center">Cas Concret : Installation CVC</h5>
                                <div class="grid md:grid-cols-2 gap-8 mt-4">
                                    <div class="bg-white p-4 rounded-lg border">
                                        <h6 class="font-semibold">R√¥le d'Helexia</h6>
                                        <p class="text-sm text-gray-600 mt-2">Nous r√©alisons les plans et le cahier des charges technique de la CVC. Nous aidons le client √† choisir l'installateur, puis nous dirigeons les r√©unions de chantier et validons la conformit√© des travaux.</p>
                                        <p class="text-sm text-gray-600 mt-2"><b>Obligation :</b> Notre responsabilit√© est engag√©e si la CVC est mal dimensionn√©e (erreur de conception) ou si nous n'avons pas d√©tect√© une malfa√ßon √©vidente (d√©faut de supervision).</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border">
                                        <h6 class="font-semibold">R√¥le du Prestataire (Installateur CVC)</h6>
                                        <p class="text-sm text-gray-600 mt-2">Il signe un contrat avec le client et doit installer la CVC en suivant nos plans et nos directives sur le chantier.</p>
                                        <p class="text-sm text-gray-600 mt-2"><b>Obligation :</b> Il a une obligation de r√©sultat sur la qualit√© de son ex√©cution directement envers le client.</p>
                                    </div>
                                </div>
                                <div class="mt-6">
                                    <h6 class="font-semibold mb-2">Exemple de Clause de Responsabilit√© (MOE)</h6>
                                    <div class="clause-box">Helexia s'engage √† concevoir et √† piloter la r√©alisation de l'installation CVC conform√©ment aux r√®gles de l'art et aux sp√©cifications d√©finies dans le cahier des charges. La responsabilit√© d'Helexia est engag√©e en cas de d√©faut de conception ou de manquement dans sa mission de supervision des travaux qui rendrait l'ouvrage impropre √† sa destination.</div>
                                </div>
                                <div class="mt-6 bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                                    <p class="text-sm font-semibold">Conclusion : La diff√©rence cl√© avec l'EPC</p>
                                    <p class="text-sm text-gray-700 mt-1">En MOE, le client garde la charge de deux contrats. En cas de litige, il peut y avoir un d√©bat pour savoir si la faute incombe au concepteur (Helexia) ou √† l'ex√©cutant (l'Entreprise). En EPC, ce d√©bat n'existe pas pour le client : <b>Helexia est son unique responsable pour tout</b>, de la conception √† l'ex√©cution, en plus de garantir la performance.</p>
                                </div>
                            </div>
                        </div>
                    `,
                    epc: `
                        <div class="space-y-8">
                            <div>
                                <h4 class="font-semibold text-xl text-center mb-6">Sch√©ma EPC : Helexia garantit</h4>
                                <div class="flex items-center justify-center">
                                    <div class="flex items-center w-full max-w-4xl">
                                        <div class="diagram-box">Client</div>
                                        <div class="diagram-arrow"><span class="diagram-arrow-label">Contrat de Performance √ânerg√©tique</span></div>
                                        <div class="diagram-box">Helexia</div>
                                        <div class="diagram-arrow"><span class="diagram-arrow-label">Contrat de Sous-traitance</span></div>
                                        <div class="diagram-box">Entreprise</div>
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <h5 class="font-bold text-lg mb-3">Obligations G√©n√©rales</h5>
                                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                                        <li><b>Client :</b> Doit payer Helexia et respecter les conditions d'usage du b√¢timent.</li>
                                        <li><b>Helexia :</b> M√™mes obligations qu'en MOE, AVEC en plus une <b>obligation de r√©sultat sur la performance chiffr√©e</b>.</li>
                                        <li><b>Entreprise :</b> M√™mes obligations qu'en MOE.</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-bold text-lg mb-3">Flux Financiers (Qui paie qui ?)</h5>
                                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                                        <li><b>Client ‚Üí Helexia</b> (pour la totalit√© de la mission).</li>
                                        <li><b>Helexia ‚Üí Entreprise</b> (pour les travaux).</li>
                                        <li class="text-red-600 font-medium"><b>Helexia ‚Üí Client</b> (en cas de non-performance).</li>
                                    </ul>
                                </div>
                            </div>
                            <hr>
                             <div>
                                <h5 class="font-bold text-lg mb-3 text-center">Cas Concret : Installation CVC</h5>
                                <div class="grid md:grid-cols-2 gap-8 mt-4">
                                    <div class="bg-white p-4 rounded-lg border">
                                        <h6 class="font-semibold">R√¥le d'Helexia</h6>
                                        <p class="text-sm text-gray-600 mt-2">Nous concevons, pilotons l'installation et, surtout, nous nous engageons √† ce que la nouvelle CVC permette au client d'√©conomiser 100 MWh/an.</p>
                                        <p class="text-sm text-gray-600 mt-2"><b>Obligation :</b> Nous avons une obligation de r√©sultat sur la <b>performance √©nerg√©tique</b>. Si l'√©conomie n'est que de 80 MWh, notre responsabilit√© est engag√©e.</p>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border">
                                        <h6 class="font-semibold">R√¥le du Prestataire (Installateur CVC)</h6>
                                        <p class="text-sm text-gray-600 mt-2">Il est notre sous-traitant. Il doit installer la CVC parfaitement, selon nos plans, pour qu'elle puisse atteindre la performance attendue.</p>
                                        <p class="text-sm text-gray-600 mt-2"><b>Obligation :</b> Il a une obligation de r√©sultat sur la qualit√© de son installation envers nous, Helexia.</p>
                                    </div>
                                </div>
                                <div class="mt-6">
                                    <h6 class="font-semibold mb-2">Exemple de Clause de Responsabilit√© (EPC)</h6>
                                    <div class="clause-box">Helexia garantit que l'Ouvrage permettra d'atteindre la Performance √ânerg√©tique d√©finie en Annexe X. En cas de non-atteinte de la performance garantie, constat√©e contradictoirement selon le protocole de Mesure & V√©rification, Helexia s'engage, √† ses frais, √† r√©aliser les actions correctives n√©cessaires pour r√©tablir la performance. Helexia indemnisera √©galement le Client pour le pr√©judice subi du fait de la moindre performance durant la p√©riode concern√©e.</div>
                                </div>
                                <div class="mt-6 bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                                    <p class="text-sm font-semibold">Conclusion : Qui porte l'obligation de r√©sultat ?</p>
                                    <p class="text-sm text-gray-700 mt-1">Helexia porte une <b>double obligation de r√©sultat</b> envers le client : celle de la conformit√© de l'ouvrage (comme en MOE) ET celle de la performance √©nerg√©tique chiffr√©e. C'est cette seconde garantie qui fait toute la sp√©cificit√© et la valeur de l'EPC.</p>
                                </div>
                            </div>
                        </div>
                    `
                },
                obligations: {
                    amo: `<p><b>Obligation :</b> Moyens (devoir de conseil).</p><hr class="my-3"><p><b>Assurance :</b> Responsabilit√© Civile Professionnelle (RC Pro).</p>`,
                    moe: `<p><b>Obligation :</b> R√©sultat (Conception) & Moyens (Suivi).</p><hr class="my-3"><p><b>Assurances :</b> RC Pro + <b>RC D√©cennale OBLIGATOIRE</b>.</p>`,
                    epc: `<p><b>Obligation :</b> Double R√©sultat (Ouvrage + Performance).</p><hr class="my-3"><p><b>Assurances :</b> RC Pro + RC D√©cennale + Garanties financi√®res.</p>`
                },
                analyse: {
                    amo: `<div class="space-y-4"><div><p class="font-semibold text-sm mb-1">Risque pour le Client</p><div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-red-500 h-4 rounded-full" style="width: 80%"></div></div><p class="text-xs text-gray-500 mt-1"><b>Exemple :</b> Le client choisit un prestataire non qualifi√© qui fait faillite ; le projet est bloqu√©.</p></div><div><p class="font-semibold text-sm mb-1">Potentiel de CA pour Helexia</p><div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-blue-500 h-4 rounded-full" style="width: 20%"></div></div></div></div>`,
                    moe: `<div class="space-y-4"><div><p class="font-semibold text-sm mb-1">Risque pour le Client</p><div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-yellow-500 h-4 rounded-full" style="width: 40%"></div></div><p class="text-xs text-gray-500 mt-1"><b>Exemple :</b> Un litige √©clate entre Helexia (concepteur) et l'entreprise (ex√©cutant) sur l'origine d'une malfa√ßon, retardant la r√©solution pour le client.</p></div><div><p class="font-semibold text-sm mb-1">Potentiel de CA pour Helexia</p><div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-blue-500 h-4 rounded-full" style="width: 50%"></div></div></div></div>`,
                    epc: `<div class="space-y-4"><div><p class="font-semibold text-sm mb-1">Risque pour le Client</p><div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-green-500 h-4 rounded-full" style="width: 5%"></div></div><p class="text-xs text-gray-500 mt-1"><b>Exemple :</b> Le client modifie les conditions d'usage du b√¢timent (ex: surchauffe volontaire), ce qui annule la garantie de performance.</p></div><div><p class="font-semibold text-sm mb-1">Potentiel de CA pour Helexia</p><div class="w-full bg-gray-200 rounded-full h-4"><div class="bg-blue-500 h-4 rounded-full" style="width: 100%"></div></div></div></div>`
                }
            };
            
            const quizData = [
                {
                    q: "Qui signe le contrat avec l'entreprise de travaux dans un contrat MOE ?",
                    options: ["Helexia", "Le Client", "Les deux"],
                    answer: "Le Client",
                    explanation: "En MOE stricte, Helexia con√ßoit et supervise, mais le Client (Ma√Ætre d'Ouvrage) reste celui qui contractualise avec l'entreprise qui ex√©cute les travaux."
                },
                {
                    q: "Quelle est la diff√©rence FONDAMENTALE entre un contrat MOE et un contrat EPC ?",
                    options: ["Le prix", "La gestion des sous-traitants", "L'engagement de performance chiffr√©e"],
                    answer: "L'engagement de performance chiffr√©e",
                    explanation: "L'EPC est le seul contrat qui inclut une garantie sur un r√©sultat mesurable (ex: kWh √©conomis√©s). C'est sa caract√©ristique principale."
                },
                {
                    q: "Dans quel contrat le risque pour le client est-il le plus √©lev√© ?",
                    options: ["AMO", "MOE", "EPC"],
                    answer: "AMO",
                    explanation: "En AMO, le client porte l'enti√®re responsabilit√© du projet, des choix techniques et de la relation avec les entreprises. Le r√¥le d'Helexia est limit√© au conseil."
                },
                {
                    q: "Quelle assurance est obligatoire pour Helexia en MOE et EPC, mais pas en AMO ?",
                    options: ["La RC Professionnelle", "La RC D√©cennale", "La garantie financi√®re"],
                    answer: "La RC D√©cennale",
                    explanation: "D√®s qu'Helexia intervient en tant que concepteur (MOE) ou EPCiste, l'assurance d√©cennale devient obligatoire pour couvrir les dommages majeurs sur l'ouvrage pendant 10 ans."
                },
                {
                    q: "Dans quel contrat Helexia a-t-elle une obligation de MOYENS envers le client ?",
                    options: ["AMO", "MOE", "EPC"],
                    answer: "AMO",
                    explanation: "En AMO, le r√¥le d'Helexia est de conseiller. C'est une obligation de moyens. En MOE et EPC, Helexia a une obligation de r√©sultat sur la conformit√© de l'ouvrage (et la performance pour l'EPC)."
                }
            ];
            
            let userScores = { avant: null, apres: null };
            let userAnswers = { avant: {}, apres: {} };
            let questionsOrderApres = [...quizData].sort(() => Math.random() - 0.5);

            const comparatorBtns = document.querySelectorAll('.comparator-btn');
            const gridView = document.getElementById('comparator-grid-view');
            const schemaView = document.getElementById('schema-details-view');
            const contentAmo = document.getElementById('content-amo');
            const contentMoe = document.getElementById('content-moe');
            const contentEpc = document.getElementById('content-epc');

            function updateComparator(criterion) {
                if (criterion === 'schema') {
                    gridView.classList.add('hidden');
                    schemaView.classList.remove('hidden');
                    setupSchemaTabs();
                } else {
                    schemaView.classList.add('hidden');
                    gridView.classList.remove('hidden');
                    contentAmo.innerHTML = trainingData[criterion].amo;
                    contentMoe.innerHTML = trainingData[criterion].moe;
                    contentEpc.innerHTML = trainingData[criterion].epc;
                }

                comparatorBtns.forEach(btn => {
                    btn.classList.toggle('bg-blue-500', btn.dataset.criterion === criterion);
                    btn.classList.toggle('text-white', btn.dataset.criterion === criterion);
                    btn.classList.toggle('bg-gray-200', btn.dataset.criterion !== criterion);
                    btn.classList.toggle('text-gray-700', btn.dataset.criterion !== criterion);
                });
            }

            function setupSchemaTabs() {
                const tabButtons = document.querySelectorAll('.schema-tab-btn');
                const schemaContentDisplay = document.getElementById('schema-content-display');

                function showSchema(schemaName) {
                    schemaContentDisplay.innerHTML = trainingData.schema[schemaName];
                    tabButtons.forEach(btn => {
                        const isSelected = btn.dataset.schema === schemaName;
                        btn.classList.toggle('border-blue-500', isSelected);
                        btn.classList.toggle('text-blue-600', isSelected);
                        btn.classList.toggle('border-transparent', !isSelected);
                        btn.classList.toggle('text-gray-500', !isSelected);
                        btn.classList.toggle('hover:text-gray-700', !isSelected);
                        btn.classList.toggle('hover:border-gray-300', !isSelected);
                    });
                }

                tabButtons.forEach(btn => {
                    btn.addEventListener('click', () => showSchema(btn.dataset.schema));
                });

                showSchema('amo'); // Show the first tab by default
            }

            comparatorBtns.forEach(btn => {
                btn.addEventListener('click', () => updateComparator(btn.dataset.criterion));
            });
            
            updateComparator('schema');

            // Argumentaire Section Logic
            const decisionTreeContainer = document.getElementById('decision-tree');
            const objectionsContainer = document.getElementById('objections-accordion');

            function renderDecisionTree(step) {
                let content = '';
                switch (step) {
                    case 1:
                        content = `<p class="font-semibold text-lg mb-4">1. Le client veut-il g√©rer lui-m√™me ses contrats travaux et ses artisans ?</p><div class="flex space-x-4"><button onclick="window.renderDecisionTree(2)" class="bg-blue-500 text-white px-4 py-2 rounded-md w-full">NON</button><button onclick="window.renderDecisionTree('amo')" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md w-full">OUI</button></div>`;
                        break;
                    case 2:
                        content = `<p class="font-semibold text-lg mb-4">2. Le client veut-il une garantie contractuelle sur ses futures √©conomies d'√©nergie ?</p><div class="flex space-x-4"><button onclick="window.renderDecisionTree('epc')" class="bg-blue-500 text-white px-4 py-2 rounded-md w-full">OUI</button><button onclick="window.renderDecisionTree('moe')" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md w-full">NON</button></div><button onclick="window.renderDecisionTree(1)" class="text-sm text-blue-600 mt-4 block">Retour</button>`;
                        break;
                    case 'amo':
                        content = `<div class="text-center p-4 bg-blue-100 border-l-4 border-blue-500 rounded"><p class="font-bold text-xl">Proposer l'AMO</p><p class="mt-2 text-gray-700">C'est un client qui veut garder la ma√Ætrise et qui a les ressources pour le faire.</p></div><button onclick="window.renderDecisionTree(1)" class="text-sm text-blue-600 mt-4 block mx-auto">Recommencer</button>`;
                        break;
                    case 'moe':
                        content = `<div class="text-center p-4 bg-green-100 border-l-4 border-green-500 rounded"><p class="font-bold text-xl">Proposer la MOE</p><p class="mt-2 text-gray-700">C'est la solution "confort et expertise" par excellence pour un projet bien men√© sans souci.</p></div><button onclick="window.renderDecisionTree(1)" class="text-sm text-blue-600 mt-4 block mx-auto">Recommencer</button>`;
                        break;
                    case 'epc':
                        content = `<div class="text-center p-4 bg-yellow-100 border-l-4 border-yellow-500 rounded"><p class="font-bold text-xl">Proposer l'EPC</p><p class="mt-2 text-gray-700">Son besoin n'est pas un projet, c'est une performance financi√®re garantie. C'est votre meilleur argument.</p></div><button onclick="window.renderDecisionTree(1)" class="text-sm text-blue-600 mt-4 block mx-auto">Recommencer</button>`;
                        break;
                }
                decisionTreeContainer.innerHTML = content;
            }
            window.renderDecisionTree = renderDecisionTree;
            renderDecisionTree(1);

            const objections = [
                 { 
                    q: "Pourquoi choisir une MOE plut√¥t qu'un EPC ?",
                    a: `C'est une excellente question. L'EPC offre la s√©curit√© maximale, mais la MOE est souvent le meilleur compromis pour plusieurs raisons :<br><br>
                        <ul class="list-disc list-inside space-y-2">
                            <li><b>Le Co√ªt :</b> Un EPC est plus cher car nous int√©grons le co√ªt de la garantie et des √©tudes de risque plus pouss√©es. La MOE est plus comp√©titive pour un client dont le budget est le crit√®re principal.</li>
                            <li><b>L'Objectif du Client :</b> Un client qui veut simplement un projet "cl√© en main" bien r√©alis√© sans se soucier de la gestion des artisans trouvera son bonheur avec la MOE. Il ach√®te de la tranquillit√© technique. Le client EPC, lui, ach√®te une garantie financi√®re.</li>
                            <li><b>La Simplicit√© :</b> La MOE est contractuellement plus simple et plus rapide √† mettre en place qu'un EPC qui n√©cessite un plan de Mesure & V√©rification complexe.</li>
                        </ul><br>
                        En r√©sum√©, la MOE est l'offre "confort et expertise" l√† o√π l'EPC est l'offre "garantie et investissement".`
                },
                { 
                    q: "En MOE/EPC, le recours du client n'est-il pas compliqu√© ?",
                    a: "Au contraire, il est simplifi√©. Dans les deux cas, le client n'a qu'un seul interlocuteur et responsable : Helexia. Si un probl√®me survient, il se tourne vers nous. C'est ensuite √† nous de g√©rer le recours contre notre sous-traitant. Le client est totalement prot√©g√© de ces d√©marches. La diff√©rence est que pour l'EPC, le client n'a m√™me pas √† prouver la faute, juste la non-atteinte de la performance."
                },
                { 
                    q: "L'offre EPC est plus ch√®re et compliqu√©e...",
                    a: "La complexit√© technique et le suivi sont justement ce que nous prenons en charge. Pour le client, le r√©sultat est au contraire tr√®s simple : <strong>une ligne dans son budget qui est garantie</strong>. Nous transformons un risque technique et une d√©pense variable en une certitude financi√®re. C'est l'offre la plus simple du point de vue d'un directeur financier."
                }
            ];
            
            objectionsContainer.innerHTML = objections.map(item => `<div class="bg-white rounded-lg shadow-md"><button class="accordion-btn w-full text-left p-4 font-semibold flex justify-between items-center"><span>${item.q}</span><span class="transform transition-transform duration-300 ">‚ñº</span></button><div class="accordion-content px-4"><p class="text-gray-600 pb-4">${item.a}</p></div></div>`).join('');
            
            document.querySelectorAll('.accordion-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const arrow = button.querySelector('span:last-child');
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                        document.querySelectorAll('.accordion-btn span:last-child').forEach(a => a.style.transform = 'rotate(0deg)');
                        content.style.maxHeight = content.scrollHeight + "px";
                        arrow.style.transform = 'rotate(180deg)';
                    }
                });
            });
            
            // Questionnaire Logic
            const quizTabs = document.querySelectorAll('.quiz-tab-btn');
            const quizContent = document.getElementById('quiz-content');

            function renderQuiz(type, showResults = false) {
                const questions = (type === 'avant') ? quizData : questionsOrderApres;
                let html = `<form id="quiz-form-${type}"><div class="space-y-6">`;
                
                questions.forEach((item, index) => {
                    const questionId = quizData.indexOf(item);
                    const userAnswer = userAnswers[type][questionId];
                    html += `
                        <div>
                            <p class="font-semibold">${index + 1}. ${item.q}</p>
                            <div class="mt-2 space-y-2">
                                ${item.options.map(opt => `
                                    <label class="flex items-center">
                                        <input type="radio" name="q${questionId}" value="${opt}" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500" ${showResults ? 'disabled' : ''} ${userAnswer === opt ? 'checked' : ''}>
                                        <span class="ml-3 text-gray-700">${opt}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';

                if (showResults) {
                    let score = userScores[type];
                    let scoreHtml = `<div class="mt-8 text-center p-4 rounded-lg border">
                                        <h3 class="text-xl font-bold">Votre score : <span class="text-blue-600">${score} / ${quizData.length}</span></h3>`;
                    if (type === 'apres' && userScores.avant !== null) {
                         scoreHtml += `<p class="mt-2 text-gray-600">Score avant la formation : ${userScores.avant} / ${quizData.length}</p>`;
                    }
                    scoreHtml += `</div>`;
                    html = scoreHtml + html;
                } else {
                    html += `<div class="mt-8 text-center"><button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700">Soumettre</button></div>`;
                }
                html += '</form>';
                quizContent.innerHTML = html;

                if (!showResults) {
                    document.getElementById(`quiz-form-${type}`).addEventListener('submit', (e) => {
                        e.preventDefault();
                        handleSubmitQuiz(type);
                    });
                } else {
                     const form = document.getElementById(`quiz-form-${type}`);
                     questions.forEach((item, index) => {
                        const questionId = quizData.indexOf(item);
                        const selectedValue = userAnswers[type][questionId];
                        const correct = item.answer;
                        const parentDiv = form.querySelectorAll('.space-y-6 > div')[index];
                        
                        let resultHtml = `<div class="mt-3 p-3 rounded-md text-sm">`;
                        if (selectedValue === correct) {
                            resultHtml += `<p class="font-bold text-green-800">‚úÖ Correct !</p>`;
                        } else {
                             resultHtml += `<p class="font-bold text-red-800">‚ùå Incorrect.</p>`;
                        }
                        resultHtml += `<p class="mt-1"><span class="font-semibold">Explication :</span> ${item.explanation}</p></div>`;
                        parentDiv.insertAdjacentHTML('beforeend', resultHtml);
                     });
                }
            }
            
            function handleSubmitQuiz(type) {
                const questions = (type === 'avant') ? quizData : questionsOrderApres;
                let score = 0;
                const form = document.getElementById(`quiz-form-${type}`);
                questions.forEach((item, index) => {
                    const questionId = quizData.indexOf(item);
                    const selected = form.querySelector(`input[name="q${questionId}"]:checked`);
                    const selectedValue = selected ? selected.value : null;
                    userAnswers[type][questionId] = selectedValue;
                    if (selectedValue === item.answer) {
                        score++;
                    }
                });
                userScores[type] = score;
                renderQuiz(type, true);
            }

            function setupQuizTabs() {
                quizTabs.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const type = btn.dataset.quiz;
                        renderQuiz(type, userScores[type] !== null);
                        quizTabs.forEach(b => {
                            const isSelected = b.dataset.quiz === type;
                            b.classList.toggle('border-blue-500', isSelected);
                            b.classList.toggle('text-blue-600', isSelected);
                            b.classList.toggle('border-transparent', !isSelected);
                            b.classList.toggle('text-gray-500', !isSelected);
                        });
                    });
                });
                 quizTabs[0].click();
            }

            // Navigation Logic
            const mainSections = document.querySelectorAll('.main-section');
            const navLinks = document.querySelectorAll('.nav-link');
            const mobileNav = document.getElementById('mobile-nav');

            function setActiveSection(sectionId) {
                mainSections.forEach(section => {
                    section.style.display = (section.id === sectionId) ? 'block' : 'none';
                });
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === `#${sectionId}`);
                });
                if (document.activeElement !== mobileNav) {
                    mobileNav.value = sectionId;
                }
                if (sectionId === 'questionnaire') {
                    setupQuizTabs();
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('href').substring(1);
                    setActiveSection(sectionId);
                    window.history.pushState({section: sectionId}, '', `#${sectionId}`);
                });
            });
            
            document.getElementById('alert-quiz-link').addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = e.target.getAttribute('href').substring(1);
                setActiveSection(sectionId);
                window.history.pushState({section: sectionId}, '', `#${sectionId}`);
            });
            
            mobileNav.addEventListener('change', (e) => {
                setActiveSection(e.target.value);
                window.history.pushState({section: e.target.value}, '', `#${e.target.value}`);
            });

            window.addEventListener('popstate', (e) => {
                if (e.state && e.state.section) {
                    setActiveSection(e.state.section);
                } else {
                    setActiveSection('accueil');
                }
            });

            const initialSection = window.location.hash ? window.location.hash.substring(1) : 'accueil';
            setActiveSection(initialSection);
        });
    </script>
</body>
</html>
